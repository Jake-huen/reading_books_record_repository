### 파일 소유자와 소유 그룹

파일의 소유자는 해당 파일에 대한 접근 권한을 자유롭게 설정할 수 있다.

`ls -l` 을 지정하면 파일의 소유자를 확인할 수 있다. 

### 그룹

그룹이란 사용자들을 묶은 그룹을 말한다. 예를 들어 시스템 관리를 수행하는 wheel이라는 그룹을 만든 뒤 여러 사용자를 해당 그룹에 소속시키면 좀 더 쉽게 여러 사용자의 권한을 관리할 수 있다.

한 사용자는 여러 그룹에 소속될 수 있다. 그리고 어떤 사용자도 최소한 한 그룹에는 소속되어 있다. 사용자를 처음 만들 때 특별히 소속될 그룹을 지정하지 않으면 사용자 이름과 동일한 그룹에 소속된다. 

현재 본인이 어떤 그룹에 소속되어 있는지 확인하려면 `groups` 라는 명령어를 사용하면 된다. 

## 파일의 퍼미션

리눅스의 각 파일에는 **’누구에게 어떤 권한을 허가할지’에 대한 정보**가 설정되어 있다. 이를 퍼미션(permission)이라 한다.

파일의 퍼미션도 소유자를 확인할 때와 마찬가지로 ls 명령어에 -l 옵션을 지정하여 확인할 수 있다. 

예를 들어 `-rwxr-xr-x. 1 root root 54048` 일 때, 맨 처음 `-` 는 파일 타입을 의미하고 그 뒤에 부분 `rwxr-xr-x` 는 퍼미션을 의미한다.

파일 타입은 `-` 는 일반 파일, `d` 는 디렉터리, `l` 은 심볼릭 링크를 의미한다.

파일 타입에 이어서 나오는 9글자를 파일 모드라고 하며, 파일의 퍼미션을 의미한다.

3글자씩 소유자, 소유 그룹, 그 외의 사용자에 대한 퍼미션을 나타낸다.

여기서 r, w, x 는 각각 읽기, 쓰기, 실행에 대한 권한을 의미한다.

### 디렉터리의 퍼미션

파일과 마찬가지로 디렉터리에도 퍼미션을 설정할 수 있다. 디렉터리에 설정된 퍼미션을 확인하기 위해서는 ls 명령을 실행할 때 -l 옵션과 함께 디렉터리의 정보를 표시하는 -d 옵션을 지정한다.

`ls -ld dir1`

→ `drwxrwxr-x 2 ldk ldk 4896`

디렉터리의 퍼미션도 파일과 마찬가지로 r, w, x라는 문자로 표시된다. 하지만 각각이 의미하는 바가 파일과 다르다. 

디렉터리에 대한 읽기 권한이 있으면 해당 디렉터리에 있는 파일의 목록을 확인할 수 있다. 만약 디렉터리에 대한 읽기 권한이 없다면 ls 명령이 실패하게 된다.

디렉터리에 대한 쓰기 권한이 있다면 해당 디렉터리 밑에 파일을 만들거나 지울 수 있다. 여기서 **파일을 지울 수 있는지 여부가 파일이 아니라 디렉터리의 퍼미션에 의해 결정된다.**

즉, 파일에 대한 쓰기 권한이 없어도 디렉터리의 쓰기 권한이 있다면 삭제가 가능하다. 

디렉터리에 대한 실행 권한이 있다면 cd 명령어로 해당 디렉터리로 이동하거나 디렉터리 안에 있는 파일을 읽고 쓸 수 있다. 

다른 사용자가 볼 수 있게 하려면 보통 `rwxr-xr-x` 라는 퍼미션을 설정한다. 그러면 소유자는 모든 권한을 갖게 되며, 다른 사용자들은 cd 명령어로 이동하여 파일을 읽을 수 있다. 그러나 다른 사용자가 파일을 만들거나 지울 수는 없다.

## chmod 명령어 : 파일 모드 변경

파일이나 디렉토리의 퍼미션을 설정하려면 `chmod` 라는 명령어를 사용해야 한다. 

이때 두 가지 방법으로 퍼미셔을 설정할 수 있는데, 기호를 사용하는 기호 모드와 수치를 사용하는 수치 모드이다. 

파일 모드의 변경은 해당 파일의 소유자 혹은 슈퍼 사용자만 가능하다. 

### 기호 모드

`chmod [ugoa] [+-=] [rwx] <파일 이름>`

![image](https://github.com/Jake-huen/reading_books_record_repository/assets/57055730/2139c47c-fa43-497a-a504-fee73a5cff93)


먼저, ugoa는 어떤 사용자에게 퍼미션을 부여할지를 의미한다.

`u` : 소유자

`g` : 소유 그룹

`o` : 기타 사용자

`a` : ugo 모두

그리고, +, -, =는 퍼미션을 허용할 것인지 금지할 것인지를 의미한다.

`+` : 퍼미션을 추가함

`-` : 퍼미션을 금지함

`=` : 지정한 퍼미션과 같게 함

ex> file.txt라는 파일의 소유자에게 읽기 퍼미션을 부여하자.

`chmod u+r file.txt`

### 수치 모드

`chmod <8진수의 수치> <파일 이름>`

기호 모드가 상대적으로 퍼미션을 지정하는 반면 수치 모드는 기존 퍼미션을 새로운 퍼미션으로 덮어쓰게 된다.

chmod를 755로 지정하면 rwxr-xr-x가 적용된다.

`chmod 755 file.txt`

## 슈퍼 사용자

리눅스에는 관리자 권한을 가지는 특별한 사용자인 슈퍼 사용자가 있다. 슈퍼 사용자는 root라는 이름을 가져서 루트 사용자라고도 불린다. 반대로 슈퍼 사용자가 아닌 사용자를 일반 사용자라고 한다.

슈퍼 사용자는 강력한 권한을 가지고 있어 시스템 설정 파일을 바꾸거나 새로운 애플리케이션을 설치할 수 있다. 

그리고 파일에 설정된 퍼미션을 무시하고 모든 파일을 읽고 수정하고 삭제할 수 있다.

일반 사용자에서 슈퍼 사용자로 전환하는 방법은 su 명령어와 sudo 명령어가 있다.

### su 명령어

su 명령어를 사용하면 일시적으로 다른 사용자로 전환할 수 있다. 즉, 로그아웃하지 않고 다른 사용자가 될 수 있다. 주로 슈퍼 사용자로 전환하기 위해 사용한다. 

슈퍼 사용자로서 작업이 끝났으면 exit 명령어로 다시 일반 사용자로 돌아갈 수 있다.

su를 통해 슈퍼 사용자가 되었을 때, 환경 변수나 현재 디렉터리는 일반 사용자의 상태가 유지가 된다. 

슈퍼 사용자의 환경으로 초기화하고 싶으면 하이픈을 추가해서 실행해야 한다. 

`su -` : 슈퍼 사용자의 환경으로 초기화하면서 전환

### sudo 명령어 : 명령어를 다른 사용자가 되어 실행

sudo 명령어를 사용하면 다른 사용자가 되어 명령어를 실행할 수 있다. 사용자를 지정하지 않으면 슈퍼 사용자로 명령어를 실행한다. 

주로 일반 사용자로 로그인한 뒤 슈퍼 사용자로만 실행할 수 있는 명령어를 실행하기 위해 사용한다.

sudo 명령어를 실행하면 현재 로그인한 사용자의 암호를 입력해서 사용할 수 있다.

### sudo vs su

sudo는 한 명령어만 슈퍼 사용자로 실행하기 위한 명령어라서 지정한 명령어가 끝나면 일반 사용자로 돌아온다. 

반면 su 명령어로 슈퍼 사용자로 전환하면 exit 하기 전까지는 슈퍼 사용자인 채로 있게 된다. 

sudo를 실행할 때 입력하는 암호는 슈퍼 사용자의 암호가 아니라 현재 로그인한 사용자의 암호이다. 

그러나 su 명령어는 슈퍼 사용자의 암호를 입력해야 한다.

### sudo 와 su 중 어느것을 사용하는 것이 좋을까

su의 경우는 exit을 하기 전까지 슈퍼 사용자인 채로 있게 된다. 슈퍼 사용자로 오랜 시간 조작하다 보면 작은 실수로 시스템에 돌이킬 수 없는 손상을 가할 수도 있다. 그래서 su보다는 sudo가 많이 사용되는 추세이다.
